webpackJsonp([9],{"2Aaf":function(e,t){},"9P5o":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("y6A+"),s=a("rVsN"),l=a.n(s),o=a("IxEa"),r=a("a/de"),u=a("yHTr"),c={props:{selectedData:{type:[Array,null],default:function(){return[]}},delurl:{type:String,default:""},isAdd:{default:!1,type:Boolean},isDelete:{default:!1,type:Boolean}},data:function(){return{addLoading:!1,deleteLoading:!1}},methods:{addDevice:function(){this.$route.path.substring(this.$route.path.lastIndexOf("/")+1);var e=this.$route.path.substring(0,this.$route.path.lastIndexOf("/")+1)+"add";console.log(e),router.replace(e)},DeleteDevice:function(){var e=this;if(this.selectedData){this.addLoading=!this.addLoading;var t={devices:[]};selectedData.forEach(function(e){t.devices[i]={did:e,groupIds:[]}}),this.apiPost(delurl,t).then(function(t){e.handleResponse(t,function(a){t.result?swal("","Delete successfully","success").then(function(){_g.shallowRefresh(e.$route.name)}):e.deleteLoading=!deleteLoading})})}else swal("","Please selected data","info")}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.isAdd?a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.addLoading,expression:"addLoading"}],attrs:{size:"small",type:"primary"},on:{click:function(t){e.addDevice()}}},[e._v("Add")]):e._e(),e._v(" "),e.isDelete?a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.deleteLoading,expression:"deleteLoading"}],attrs:{size:"small",type:"primary"},on:{click:function(t){e.DeleteDevice()}}},[e._v("Delete")]):e._e()],1)},staticRenderFns:[]},g=(a("C7Lr")(c,d,!1,null,null,null).exports,{name:"messageList",data:function(){return{messageList:[],msgTableData:[],multipleTable:[],limit:10,categoryValue:"",isshow:!1,groupValue:"",severityValue:"All",dataCount:null,currentPage:1,groupOptions:[],categoryOptions:[],severityOptions:[{value:"All",label:"All"},{value:"Information",label:"Information"},{value:"Warning",label:"Warning"},{value:"Error",label:"Error"}]}},methods:{getDeviceGroup:function(){var e=this;Object(n.c)().then(function(t){Object(u.a)(t,function(t){var a=t.accounts[0].groups;if(console.log(a),0!=a.length){var n=[];a.forEach(function(e){n.push({value:e.gid,label:e.name})}),e.groupValue=a[0].gid,e.groupOptions=n}else e.groupOptions=[];e.$nextTick(function(){this.getEventMessages()})})})},getDeviceCategory:function(){var e=this;new l.a(function(e,t){var a={type:"Device",_:(new Date).getTime()};Object(o.b)("rmm/v1/notifymgmt/category",a).then(function(t){e(t)}).catch(function(t){e(t.response)})}).then(function(t){Object(u.a)(t,function(a){if(t.result)e.categoryOptions=[];else{var n=[];a.result.forEach(function(e){n.push({value:e.tag.toLowerCase(),label:e.Description})}),e.categoryValue=a.result[0].tag.toLowerCase(),e.categoryOptions=n}e.$nextTick(function(){this.getEventMessages()})})})},confirmDelete:function(e){_g.swalWarningDo("delete this message").then(function(t){t&&DeleteMsgApi(e.id).then(function(e){Object(u.a)(e,function(e){e.result&&swal("","Delete Message successfully","success").then(function(){getEventMessages()})})})})},handleSelectionChange:function(e){this.multipleTable=e},handleCurrentChange:function(e){this.currentPage=e,this.messageList=this.msgTableData.slice((e-1)*this.limit,e*this.limit)},getEventMessages:function(){var e,t,a,n=this;""!=this.severityValue&&""!=this.groupValue&&""!=this.categoryValue&&(_g.openGlobalLoading(),(e=this.severityValue,t=this.groupValue,a=this.categoryValue,new l.a(function(n,s){Object(r.c)().then(function(s){Object(u.a)(s,function(s){var i=s.accounts[0].aid,l={severity:e,groupId:t,accountId:i,beginTs:_g.getFromNowTimes(7,0),endTs:_g.getFromNowTimes(0,0),orderType:"desc",category:a,amount:20,_:(new Date).getTime()};Object(o.b)("rmm/v1/events/devices",l).then(function(e){n(e)}).catch(function(e){n(e.response)})})})})).then(function(e){Object(u.a)(e,function(e){n.msgTableData=e.events,n.dataCount=n.msgTableData.length,n.messageList=n.msgTableData.slice(0,n.limit),n.isshow=n.dataCount>n.limit})}))}},created:function(){this.getDeviceGroup(),this.getDeviceCategory()}}),v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._m(0),e._v(" "),a("div",{staticClass:"m-t-20"},[a("div",{staticClass:"panel-header"},[e._v("\n            Severity:\n            "),a("el-select",{attrs:{size:"small"},on:{change:e.getEventMessages},model:{value:e.severityValue,callback:function(t){e.severityValue=t},expression:"severityValue"}},e._l(e.severityOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v("\n            Category:\n            "),a("el-select",{attrs:{size:"small"},on:{change:e.getEventMessages},model:{value:e.categoryValue,callback:function(t){e.categoryValue=t},expression:"categoryValue"}},e._l(e.categoryOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v("\n             Device Group:\n            "),a("el-select",{attrs:{size:"small"},on:{change:e.getEventMessages},model:{value:e.groupValue,callback:function(t){e.groupValue=t},expression:"groupValue"}},e._l(e.groupOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.messageList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{label:"Time Stamp",prop:"name","min-width":"120",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n                        "+e._s(e._f("time")(t.row.unix_ts))+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Device Name",prop:"agent_name","min-width":"120",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"Severify","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{class:["Error"==t.row.severity?"bg-red":"Warning"==t.row.severity?"bg-yellow":"bg-green"],staticStyle:{padding:"5px","border-radius":"5px"}},[e._v("\n                            "+e._s(t.row.severity)+"\n                        ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Subtype","min-width":"120",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n                        "+e._s(t.row.subtype.toLowerCase())+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Event Message",prop:"message","min-width":"120",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"Action","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){e.confirmDelete(t.row)}}},[e._v("Delete")])],1)])]}}])})],1),e._v(" "),a("div",{staticClass:"m-t-10 cf"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"isshow"}],staticClass:"fr",attrs:{layout:"prev, pager, next","page-size":e.limit,"current-page":e.currentPage,total:e.dataCount,background:""},on:{"current-change":e.handleCurrentChange}})],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"m-t-10 "},[t("p",{staticClass:"header-line"},[t("i",{staticClass:"fa fa-info c-primary m-r-10",attrs:{"aria-hidden":"true"}}),this._v("Message ")])])}]};var f=a("C7Lr")(g,v,!1,function(e){a("2Aaf")},"data-v-39563e71",null);t.default=f.exports}});
//# sourceMappingURL=9.544cc64b9b732f908a3a.js.map